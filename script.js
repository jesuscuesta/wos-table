document.getElementById("fileInput").addEventListener("change",function(t){let e=t.target.files;e.length&&(clearResults(),globalArticles=[],Array.from(e).forEach(t=>{let e=new FileReader;e.onload=function(t){let e=t.target.result;processFile(e)},e.readAsText(t)}))});let globalArticles=[];async function processFile(t){let e=t.split("\n"),r=[],s={},l=!1,n="";for(let a of e)a.startsWith("  ")||isLowerCase(a.substring(0,2))?l=!0:(l=!1,n=a.substring(0,2)),a.startsWith("AU ")&&(r.push(s),s={}),l?"AB"===n?s.abstract+="\n"+a.substring(3).trim():"DE"===n?s.authorKeyword+=" "+a.substring(3).trim():"ID"===n?s.indexKeyword+=" "+a.substring(3).trim():console.log(a.substring(0,2)):a.startsWith("AB ")?s.abstract=a.substring(3).trim():a.startsWith("DE ")?s.authorKeyword=a.substring(3).trim():a.startsWith("ID ")&&(s.indexKeyword=a.substring(3).trim());s.abstract&&r.push(s),globalArticles=[...globalArticles,...r],displayResults(r,!0)}function displayResults(t,e=!1){let r=document.getElementById("resultsTable"),s=document.getElementById("tableBody");e||(s.innerHTML="");let l=e?s.rows.length+1:1;t.forEach(t=>{let e=`<tr>
            <td>${l++}</td>
            <td>${t.abstract}</td>
            <td>${t.authorKeyword||""}</td>
            <td>${t.indexKeyword||""}</td>
        </tr>`;s.innerHTML+=e}),r.style.display="table"}function clearResults(){let t=document.getElementById("tableBody");t.innerHTML="",globalArticles=[]}function downloadCSV(t,e){let r,s;r=new Blob([t],{type:"text/csv"}),(s=document.createElement("a")).download=e,s.href=window.URL.createObjectURL(r),s.style.display="none",document.body.appendChild(s),s.click()}function exportTableToCSV(t){let e=["Index,Abstract,Author Keyword,Keyword Plus"];globalArticles.forEach((t,r)=>{let s=[r+1,`"${t.abstract.replace(/"/g,'""')}"`,`"${(t.authorKeyword||"").replace(/"/g,'""')}"`,`"${(t.indexKeyword||"").replace(/"/g,'""')}"`,];e.push(s.join(","))});let r=e.join("\n");downloadCSV(r,t)}function isLowerCase(t){return t===t.toLowerCase()&&t!==t.toUpperCase()}